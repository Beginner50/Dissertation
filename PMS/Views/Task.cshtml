@* File: Views/Tasks/Details.cshtml (Final Revision) *@
@using System.Security.Permissions

@{
    ViewData["Title"] = "Task Details";
    var taskTitle = ViewBag.TaskTitle ?? "Default Task Title";
    var taskDescription = ViewBag.TaskDescription ?? "No description provided.";
    var taskDeadline = ViewBag.TaskDeadline?.ToString("yyyy-MM-dd") ?? "N/A";
    var projectId = ViewBag.ProjectID;
    var taskId = ViewBag.TaskID;
    var taskLabel = taskId != null ? $"Task {taskId}" : "Task Details";
    var breadcrumbs = new[] { ("/projects", "Projects"), ($"/projects/{projectId}", $"Project {projectId}"),
($"/projects/{projectId}/tasks/{taskId}", taskLabel) };

    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Navigation {
    @await Component.InvokeAsync("Navigation")
}


<partial name="~/Views/PartialViews/Breadcrumbs.cshtml" model="@breadcrumbs" />
<div class="task-page-container">
    <div class="task-info-panel">

        <div class="task-main-header">
            <h1 class="task-detail-title">@taskTitle</h1>
            <p class="task-detail-deadline">Deadline: <strong>@taskDeadline</strong></p>
        </div>

        <div class="task-description-details">
            <p class="task-detail-description-text">@taskDescription</p>
        </div>

        <div class="feedback-criteria-section">
            <table class="criteria-table">
                <thead>
                    <tr>
                        <th class="criteria-col">Criteria</th>
                        <th class="status-col met-col">Met</th>
                        <th class="status-col unmet-col">Unmet</th>
                        <th class="status-col override-col">Overridden</th>
                        <th class="action-col"></th>
                    </tr>
                </thead>
                <tbody>
                    @* Sample Criteria Entries *@
                    <tr class="criteria-entry status-met">
                        <td class="criteria-text">Code passes all unit tests.</td>
                        <td class="status-cell met"><i class="bi bi-check-lg"></i></td>
                        <td class="status-cell unmet"></td>
                        <td class="status-cell overridden"></td>
                        <td class="action-cell"></td>
                    </tr>

                    <tr class="criteria-entry status-unmet">
                        <td class="criteria-text">Code documentation is complete.</td>
                        <td class="status-cell met"></td>
                        <td class="status-cell unmet">
                            <i class="bi bi-x-lg"></i>
                        </td>
                        <td class="status-cell overridden"></td>
                        <td class="action-cell">
                            <button class="criteria-override-button" title="Override Status (Unmet)">
                                <i class="bi bi-toggles"></i>
                            </button>
                        </td>
                    </tr>

                    <tr class="criteria-entry status-overridden">
                        <td class="criteria-text">External dependency checks pass.</td>
                        <td class="status-cell met"></td>
                        <td class="status-cell unmet"></td>
                        <td class="status-cell overridden">
                            <i class="bi bi-slash-lg"></i>
                        </td>
                        <td class="action-cell"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    @* Submission Panel remains the same *@
    <div class="submission-panel">
        <h3 class="section-subtitle">Deliverable Actions</h3>
        <form id="submissionForm" class="submission-form" enctype="multipart/form-data">
            <div class="file-upload-area">
                <label for="taskFile" class="file-label">
                    <i class="bi bi-upload"></i> Upload Deliverable
                </label>
                <input type="file" id="taskFile" name="taskFile" required />
                <span id="fileNameDisplay" class="file-name-display">No file selected.</span>
            </div>
            <div class="submission-actions action-separation">
                <button type="button" class="action-button feedback-button">
                    <i class="bi bi-chat-left-text"></i> Provide Feedback
                </button>
                <button type="button" class="action-button check-compliance-button">
                    <i class="bi bi-clipboard-check"></i> Check Compliance
                </button>
                <button type="submit" class="action-button submit-button">
                    <i class="bi bi-send-fill"></i> Submit Task
                </button>
            </div>
        </form>
    </div>
</div>